[{"version":"45","lock":false,"zoom":0.4695435166358948,"panx":-80.17033386230469,"pany":588.16259765625,"font_size":14,"snap_grid":true,"standard_size":true,"type":"diagram","theme":"Plain_Theme"},{"id":"865385","label":".ot. main loop","fill":"CLEAR","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"type":"BOUNDARY_BOX","center.x":-580,"center.y":20,"width":440,"height":400,"lineType":"DASHED"},{"id":"231571182","label":"","fill":"CLEAR","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"type":"BOUNDARY_BOX","center.x":-1140,"center.y":-30,"width":320,"height":340,"lineType":"DASHED"},{"id":"121618319","label":".h.pressure_sensor_obj\n.....................................\n-----------------------------------------------------\nstatic int conversion_complete_flag = 0;\n.\nstatic uint32_t fresh_pressure_value;\nstatic uint32_t fresh_temperature_value;\n-----------------------------------------------------\nvoid pressure_sensor_start_conversion();\nuint32_t pressure_sensor_read_pressure_data();\nuint32_t pressure_sensor_read_temperature_data();\nuint32_t pressure_sensor_get_pressure_data();\nuint32_t pressure_sensor_get_temperature_data();\nint pressure_sensor_get_conversion_complete_flag();\n\n\n\n","fill":"#3bc34a","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":690,"center.y":10,"points":[480.0006408691406,-160,900,-160,899.9993286132813,180,480,180],"lineType":"SOLID"},{"id":"169628188","label":".h.SPI_sensor_pipe_obj\n...........................\n","fill":"#3bc34a","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":690,"center.y":380,"points":[580,340,800.0000610351563,340,800.0000610351563,420,580,419.99993896484375],"lineType":"SOLID"},{"id":"183229272","label":".h.SPI_raspi_pipe_obj\n.......................................\nstatic int spi_raspi_rxne_flag = 0;\nstatic int spi_raspi_data_out_flag = 0;\n.........................................................\nvoid spi_raspi_get_data();\nvoid spi_raspi_shift_buffer();\nint spi_raspi_get data_out_flag();","fill":"#3bc34a","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":2380,"center.y":-90,"points":[2240,-180,2519.9990234375,-180,2520,0,2240,-3.35693359375E-4],"lineType":"SOLID"},{"id":"238812566","label":".h.pressure_data_buffer_obj\n............................................\n#define PRESSURE_DATA_BUFFER_LENGTH 128\n-----------------------------------------------------------------\nstatic uint32_t pressure_data_buffer[PRESSURE_DATA_BUFFER_LENGTH];\n------------------------------------------------------------------------------------\nvoid pressure_buffer_add_new_value();\nuint32_t pressure_buffer_get_value(int index);\nvoid pressure_buffer_shift_out_data(int length);\n","fill":"#3bc34a","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":1530,"center.y":-120,"points":[1260,-220,1800,-220,1799.99951171875,-20,1260,-20.00188446044922],"lineType":"SOLID"},{"id":"111526314","label":".h.sinchronization_scheme_obj\n.............................................\nstatic int sinchronization_start_conversion_flag = 0;\n---------------------------------------------------------------------------------\nint sinchronization_get_start_conversion_flag();\nvoid sinchronization_set_start_conversion_flag();\nvoid sinchronization_reset_start_conversion_flag();","fill":"#3bc34a","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":309.99993896484375,"center.y":600,"points":[120.00184631347656,480,499.9999084472656,480,499.9999084472656,720,120.00001525878906,720],"lineType":"SOLID"},{"id":"213626405","label":".h.temperature_data_buffer_obj\n............................................\n#define TEMPERATURE_DATA_BUFFER_LENGTH 128\n-----------------------------------------------------------------\nstatic uint32_t temperature_data_buffer[TEMPERATURE_DATA_BUFFER_LENGTH];\n------------------------------------------------------------------------------------\nvoid temperature_buffer_add_new_value();\n\n","fill":"#3bc34a","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":1530,"center.y":129.99996948242188,"points":[1260,19.999984741210938,1800,19.999984741210938,1799.999267578125,239.9993896484375,1260,239.99996948242188],"lineType":"SOLID"},{"id":"9870330","label":".h.main thread","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTGROUP","connector":0,"group":[{"thickness":2,"shape":"polygon","fill":"#ce93d8","lineType":"SOLID","points":[-500,-130.00006103515625,-540.0016479492188,-100.00012969970703,-700,-100.00000762939453,-660.0001220703125,-130,-700,-160,-540.00146484375,-160]}],"icons":[],"textbox":[-660.0001220703125,-160,-540.00146484375,-160,-540.0016479492188,-100.00012969970703,-660.0001831054688,-100.00001525878906],"textalign":"CENTER","lineType":"SOLID"},{"id":"16958891","label":".h. scheduler\n.........................\nif(sinchronization_get_start_conversion_flag())\n.pressure_sensor_start_conversion();\nif(pressure_sensor_get_conversion_complete_flag())\n.pressure_buffer_add_new_value();\nif(spi_raspi_get data_out_flag())\n.spi_raspi_get_data();","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":-580,"center.y":30,"points":[-760,-80,-400.0010070800781,-80,-400.0000305175781,139.99990844726563,-760,140],"lineType":"SOLID"},{"id":"61502472","label":".h. asinchronous events","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTGROUP","connector":0,"group":[{"thickness":2,"shape":"polygon","fill":"#ce93d8","lineType":"SOLID","points":[-1000,-150.00009155273438,-1056.001953125,-120.00012969970703,-1280,-120,-1224.000244140625,-150,-1280,-180,-1056.0020751953125,-180]}],"icons":[],"textbox":[-1224.0006103515625,-180,-1056.0020751953125,-180,-1056.001953125,-120.00012969970703,-1224.0006103515625,-120],"textalign":"CENTER","lineType":"SOLID"},{"id":"85854113","label":".h. interrupts\n............................\nspi irq (запрос на вывод данных)\ngpio irq (синхроимпульс)\ndata ready irq (зависит от ацп)","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":-1150,"center.y":-10,"points":[-1280,-100,-1020,-100,-1020.0001220703125,80,-1280,79.99983978271484],"lineType":"SOLID"},{"id":"195198406","label":"raspi spi irq\n......................\nrxne","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":-680,"center.y":590,"points":[-760,560,-600,560,-600.0003051757813,620,-760,620],"lineType":"SOLID"},{"id":"61215111","label":"принятый символ = 0x21\n.............................................\nнадо отдать 20 значений давления","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":-370,"center.y":729.9999389648438,"points":[-500,699.9999389648438,-240.0006103515625,699.9999389648438,-240,759.9998168945313,-500,759.9999389648438],"lineType":"SOLID"},{"id":"209111220","label":"20 значений готовы","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":-400,"center.y":819.9999389648438,"points":[-500,799.9999389648438,-300.00018310546875,799.9999389648438,-300,839.9999389648438,-500,839.9999389648438],"lineType":"SOLID"},{"id":"250772701","label":"отвечаем 0x23","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":-410,"center.y":899.9999389648438,"points":[-480,879.9999389648438,-340,879.9999389648438,-340,919.9999389648438,-480,919.9973754882813],"lineType":"SOLID"},{"id":"255373394","label":"отдаем 20 значений","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":-420,"center.y":1000,"points":[-500,979.9999389648438,-340,979.9999389648438,-340.0001220703125,1020.0001220703125,-500,1019.9998779296875],"lineType":"SOLID"},{"id":"38289187","label":"отвечаем 0x22","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":-130,"center.y":819.9999389648438,"points":[-200,799.9999389648438,-60,799.9999389648438,-60,839.9999389648438,-200,839.9999389648438],"lineType":"SOLID"},{"id":"68271136","label":"сдвигаем буфер","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":-400,"center.y":1100.0001220703125,"points":[-460,1080.0001220703125,-340.00006103515625,1080.0001220703125,-340,1120.0001220703125,-460,1119.9998779296875],"lineType":"SOLID"},{"id":"60754393","label":"gpio irq\n...............\nfrom low to high","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":-2210,"center.y":540.0001220703125,"points":[-2280,500.00006103515625,-2140.000244140625,500.00006103515625,-2139.999755859375,580.0001220703125,-2280,580.0001220703125],"lineType":"SOLID"},{"id":"109936542","label":"запускаем преобразование","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":-1879.9998779296875,"center.y":670,"points":[-1960,640,-1799.999755859375,640,-1800.000244140625,700,-1960,700],"lineType":"SOLID"},{"id":"156609151","label":"сохраняем значение в буфер","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":-1160,"center.y":680,"points":[-1240,660,-1080.004150390625,660,-1080,700,-1240,700],"lineType":"SOLID"},{"id":"10910284","label":"data ready irq","fill":"#ce93d8","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTBOX","border":true,"center.x":-1420,"center.y":579.9998168945313,"points":[-1480,559.9998779296875,-1360.0001220703125,559.9998779296875,-1360,599.999755859375,-1480,599.999755859375],"lineType":"SOLID"},{"id":"49113749","label":"sinchronization_start_conversion_flag","fill":"#f44336","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTGROUP","connector":0,"group":[{"thickness":2,"shape":"polygon","fill":"#f44336","lineType":"SOLID","points":[-1679.999755859375,540.0003662109375,-1764.004150390625,560,-2100,560.0001220703125,-2016.0001220703125,540.00048828125,-2100,520,-1764.005126953125,520]}],"icons":[],"textbox":[-2016.000732421875,520,-1764.005126953125,520,-1764.004150390625,560,-2016.0003662109375,560.0001220703125],"textalign":"CENTER","lineType":"SOLID"},{"id":"164493226","label":"conversion_complete_flag","fill":"#f44336","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTGROUP","connector":0,"group":[{"thickness":2,"shape":"polygon","fill":"#f44336","lineType":"SOLID","points":[-999.9999389648438,580.0006103515625,-1060.0032958984375,599.99951171875,-1300,600,-1239.9998779296875,580.0005493164063,-1300,560,-1060.003662109375,560]}],"icons":[],"textbox":[-1240.000244140625,560,-1060.003662109375,560,-1060.0032958984375,599.99951171875,-1240.000244140625,599.9999389648438],"textalign":"CENTER","lineType":"SOLID"},{"id":"94662555","label":"spi_raspi_rxne_flag","fill":"#f44336","fontSize":14,"textColor":"TEXT_DEFAULT","strokeColor":"DEFAULT","stroke":2,"ss.hideChildren":false,"ss.urlType":2,"type":"SMARTGROUP","connector":0,"group":[{"thickness":2,"shape":"polygon","fill":"#f44336","lineType":"SOLID","points":[-219.9998779296875,580.0006103515625,-280.0032958984375,599.99951171875,-520,600,-459.9998779296875,580.0006103515625,-520,560,-280.003662109375,560]}],"icons":[],"textbox":[-460.000244140625,560,-280.003662109375,560,-280.0032958984375,599.99951171875,-460.000244140625,600],"textalign":"CENTER","lineType":"SOLID"},{"id":"233238328","label":"pressure_buffer_add_new_value()\npressure_sensor_get_pressure_data()","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"121618319","connect.b":"238812566","points":[899.9996337890625,30,1260,-120.00094604492188],"arrow.b":"true","arrow.b.type":"TRIANGLE","lineType":"SOLID","connectorType":1},{"id":"92740369","label":"pressure_sensor_start_conversion()\npressure_sensor_read_pressure_data()\npressure_sensor_read_temperature_data()","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"169628188","connect.b":"121618319","points":[690,340,689.9996337890625,180],"arrow.a":"true","arrow.a.type":"TRIANGLE","arrow.b":"true","arrow.b.type":"TRIANGLE","lineType":"SOLID","connectorType":1},{"id":"82568310","label":"","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"121618319","connect.b":"213626405","points":[899.9996337890625,30,1260,129.99996948242188],"arrow.b":"true","arrow.b.type":"TRIANGLE","lineType":"SOLID","connectorType":1},{"id":"22047351","label":"","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"61215111","connect.b":"209111220","points":[-390,759.9998779296875,-400.0000915527344,799.9999389648438],"arrow.b":"true","arrow.b.type":"LINE","lineType":"SOLID","connectorType":1},{"id":"246925028","label":"","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"250772701","connect.b":"255373394","points":[-410,919.9987182617188,-420,979.9999389648438],"arrow.b":"true","arrow.b.type":"LINE","lineType":"SOLID","connectorType":1},{"id":"187782989","label":"да","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"209111220","connect.b":"250772701","points":[-400,839.9999389648438,-410,879.9999389648438],"arrow.b":"true","arrow.b.type":"LINE","lineType":"SOLID","connectorType":1},{"id":"254398978","label":"нет","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"209111220","connect.b":"38289187","points":[-300.0001220703125,819.9999389648438,-200,819.9999389648438],"arrow.b":"true","arrow.b.type":"LINE","lineType":"SOLID","connectorType":1},{"id":"39270163","label":"","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"255373394","connect.b":"68271136","points":[-420.00006103515625,1019.9998779296875,-400,1080.0001220703125],"arrow.b":"true","arrow.b.type":"LINE","lineType":"SOLID","connectorType":1},{"id":"228355408","label":"","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"60754393","connect.b":"49113749","points":[-2140,540.0001220703125,-2100,540.0000610351563],"arrow.b":"true","arrow.b.type":"LINE","lineType":"SOLID","connectorType":1},{"id":"13179721","label":"","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"49113749","connect.b":"60754393","points":[-2100,540.0000610351563,-2100,540.0001220703125,-2140,540.0001220703125],"lineType":"SOLID","connectorType":1},{"id":"258411598","label":"","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"49113749","connect.b":"109936542","points":[-1889.9998779296875,560.0001220703125,-1879.9998779296875,640],"arrow.b":"true","arrow.b.type":"LINE","lineType":"SOLID","connectorType":1},{"id":"116666735","label":"","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"10910284","connect.b":"164493226","points":[-1360,579.9998168945313,-1300,580],"arrow.b":"true","arrow.b.type":"LINE","lineType":"SOLID","connectorType":1},{"id":"132320892","label":"","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"164493226","connect.b":"156609151","points":[-1170,600,-1160.0020751953125,660],"arrow.b":"true","arrow.b.type":"LINE","lineType":"SOLID","connectorType":1},{"id":"167715589","label":"","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"195198406","connect.b":"94662555","points":[-600.0001220703125,590,-520,580],"arrow.b":"true","arrow.b.type":"LINE","lineType":"SOLID","connectorType":1},{"id":"153853786","label":"","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"94662555","connect.b":"61215111","points":[-389.99993896484375,600,-390.00030517578125,699.9999389648438],"arrow.b":"true","arrow.b.type":"LINE","lineType":"SOLID","connectorType":1},{"id":"196900235","label":"pressure_sensor_start_conversion","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"1","connect.a":"111526314","connect.b":"121618319","points":[290.0008544921875,480,80.79376220703125,310.2730712890625,177.89576721191406,-183.1288604736328,480.0002746582031,30],"arrow.b":"true","arrow.b.type":"LINE","lineType":"SOLID","connectorType":1},{"id":"22111409","label":"pressure_buffer_get_value\npressure_buffer_shift_out_data","fill":"CONNECTOR","fontSize":14,"textColor":"TEXT_DEFAULT","stroke":2,"type":"CONNECTOR","curve":"0","connect.a":"238812566","connect.b":"183229272","points":[1799.999755859375,-100,2240,-90.00016784667969],"arrow.b":"true","arrow.b.type":"LINE","lineType":"SOLID","connectorType":1}]